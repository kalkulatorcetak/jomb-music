<html>
<head>
<title>playing </title>
</head>
<body>
<h2 id="myStatus"></h2>
<button id="myMute">Mute</button>
<button id="myPlay">Play</button>
<button id="myNext">Next</button>
<button id="myPrev">Previous</button>
<div id="timebox">
	<span id="curtimetext">00:00</span> / <span id="durtimetext">00:00</span>
</div>
<div>
<input id="mySeek" type="range" min="0" max="100" value="0" step="1"/>
</div>
<div>
<span>Volume:</span>
<input id="myVolume" type="range" min="0" max="100" value="100" step="1"/>
</div>
<script>
var audio, playbtn, mutebtn, 
seekslider, volumeslider, 
seekto, seeking=false, 
curtimetext, durtimetext,
play_status, dir, playlist,
ext, playlist_index, agent,isMobile;

function initAudioPlayer() {
	// Set Object references
	playbtn = document.getElementById("myPlay");
	mutebtn = document.getElementById("myMute");
	nextbtn = document.getElementById("myNext");
	prevbtn = document.getElementById("myPrev");
	volumeslider = document.getElementById("myVolume");
	seekslider = document.getElementById("mySeek");
	curtimetext = document.getElementById("curtimetext");
	durtimetext = document.getElementById("durtimetext");
	play_status = document.getElementById("myStatus");
	
	isMobile = {
    Android: function() {
        return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function() {
        return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function() {
        return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i);
    },
    any: function() {
        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
    }
};
	// Audio Object
	audio = new Audio();
	dir = "audio/";
	playlist = ["candypop","orion","knockknock","dancenightaway","remember","tt","idontknow","yesoryes","luv","likey","mymy",
	"nonono","cheerup","five","asiflast","ooh-aah",
	"byebye","boombayah","heartshaker","mrchu",
	"playingfire","fancy","stay","whatislove"];
	playlist_index = 0;
	ext = ".mp3";
	agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('firefox') != -1 || agent.indexOf('opera') != -1 ){
		ext = ".ogg";
	}
	audio.src = dir+playlist[0]+ext;
	audio.loop = false;
	audio.play();
	play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index]+ext;
	document.title = play_status.innerText;
	
	
	playbtn.addEventListener("click", playPause);
	mutebtn.addEventListener("click", mute);
    nextbtn.addEventListener("click", nextPlay);
    prevbtn.addEventListener("click", prevPlay);
	if(isMobile.Android() || isMobile.any() ) {
	/*seekslider.addEventListener("touchend", function(event){ seeking=true; seek(event); });
	seekslider.addEventListener("touchmove", function(event){ seek(event); });
	seekslider.addEventListener("touchstart", function(){ seeking=false; });*/
	
	seekslider.addEventListener("touchstart", function(event){ seeking=true; seekandro(event); });
	seekslider.addEventListener("touchmove", function(event){ seekandro(event); });
	seekslider.addEventListener("touchend", function(){ seeking=false; });
	volumeslider.addEventListener("touchmove", setvolume);
	} else {
	seekslider.addEventListener("mousedown", function(event){ seeking=true; seek(event); });
	seekslider.addEventListener("mousemove", function(event){ seek(event); });
	seekslider.addEventListener("mouseup", function(){ seeking=false; });
	volumeslider.addEventListener("mousemove", setvolume);
	}
	audio.addEventListener("timeupdate", function() { seektimeupdate(); })
	audio.addEventListener("ended", function(){ switchTrack(); });
	
	//Functions
	function switchTrack() {
		if(playlist_index == (playlist.length - 1)){
			playlist_index = 0;
		} else {
			playlist_index++;
		}
		play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index]+ext;
		document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index]+ext;
		audio.play();
	}
	
	function playPause(){
		if(audio.paused){
			audio.play();
			playbtn.innerText = "Pause";
		} else {
			audio.pause();
			playbtn.innerText = "Play";
		}
	}
	function mute(){
		if(audio.muted){
			audio.muted = false;
		} else {
			audio.muted = true;
		}
	}
	function seek(event){
		if(seeking){
			seekslider.value = event.clientX - seekslider.offsetLeft;
			seekto = audio.duration * (seekslider.value / 100);
			audio.currentTime = seekto;
			
		}
	}
	
	function seekandro(event){
		if(seeking){
			seekslider.value = event.touches[0].clientX - seekslider.offsetLeft;
			seekto = audio.duration * (seekslider.value / 100);
			audio.currentTime = seekto;

		}
	}
	
	
	function setvolume() {
		audio.volume = volumeslider.value / 100;
	}
	function seektimeupdate() {
		var nt = audio.currentTime * (100 / audio.duration);
		seekslider.value = nt;
		var curmins = Math.floor(audio.currentTime / 60);
		var cursecs = Math.floor(audio.currentTime - curmins * 60);
		var durmins = Math.floor(audio.duration / 60);
		var dursecs = Math.floor(audio.duration - curmins * 60);
		if(cursecs < 10) { cursecs = "0"+cursecs;}
		if(dursecs < 10) { dursecs = "0"+dursecs;}
		if(curmins < 10) { curmins = "0"+curmins;}
		if(durmins < 10) { durmins = "0"+durmins;}
		curtimetext.innerHTML = curmins+":"+cursecs;
		durtimetext.innerHTML = durmins+":"+dursecs;
	}
    function nextPlay() {
        playlist_index++;
        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index]+ext;
        document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index]+ext;
		audio.play();
    }
    function prevPlay() {
        if(playlist_index < 1 ) {
         alert("Error Mbah");
        }else {
        playlist_index--;
        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index]+ext;
        document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index]+ext;
		audio.play();
        }
    }
	
}
window.addEventListener("load", initAudioPlayer);
</script>
</body>
</html>
