
<html>
<head>
<title>playing </title>
</head>
<body>
<div>
    <p>Pilih Lagu</p>
    <select id="listMusic">
        <option>Semua Lagu</option>
        <option value="twice">Twice</option>
        <option value="apink">Apink</option>
        <option value="blackpink" >BlackPink</option>
    </select>
</div>
<div>
    <p>Play Mode</p>
    <input type="radio" name="modeS" value="0" checked="checked"/>NormalSwitch
    <input type="radio" name="modeS" value="1" />RandomSwitch
</div>
<hr>
<h3 id="myStatus"></h3>
<button id="myMute">Mute</button>
<button id="myPlay">Play</button>
<button id="myNext">Next</button>
<button id="myPrev">Previous</button>
<div id="timebox">
	<span id="curtimetext">00:00</span> / <span id="durtimetext">00:00</span>
</div>
<div>
<input id="mySeek" type="range" min="0" max="100" value="0" step="1"/>
</div>
<div>
<span>Volume:</span>
<input id="myVolume" type="range" min="0" max="100" value="100" step="1"/>
</div>
<script>
var audio, playbtn, mutebtn, 
seekslider, volumeslider, 
seekto, seeking=false, 
curtimetext, durtimetext,
play_status, dir, playlist,
ext, playlist_index, agent,isMobile, 
listmusic, modeSwitch, playModeValue;

function initAudioPlayer() {
	// Set Object references
	playbtn = document.getElementById("myPlay");
	mutebtn = document.getElementById("myMute");
	nextbtn = document.getElementById("myNext");
	prevbtn = document.getElementById("myPrev");
	volumeslider = document.getElementById("myVolume");
	seekslider = document.getElementById("mySeek");
	curtimetext = document.getElementById("curtimetext");
	durtimetext = document.getElementById("durtimetext");
	play_status = document.getElementById("myStatus");
	listmusic = document.getElementById("listMusic");
	modeSwitch = document.getElementsByName("modeS");
	
	isMobile = {
    Android: function() {
        return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function() {
        return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function() {
        return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i);
    },
    any: function() {
        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
    }
};

    // Music Object
    blackpink = [
    {
        music:"1570186762",
        name:"As If Its Your Last"
    },
    {
        music: "1570187253",
        name:"Boombayah"
    },
    {
        music: "1570149074",
        name: "DDU-DU"
    },
    {
        music: "1570170030",
        name: "Dont Know What To Do"
    },
    {
        music: "1570169887",
        name: "Forever young"
    },
    {
        music: "1570146803",
        name: "Stay"
    },
    {
        music: "1570152934",
        name: "Playing with fire"
    }
    ];
    apink = [
    {
        music:"1569219977",
        name:"LUV"
    },
    {
        music:"1569177384",
        name:"Mr Chu"
    },
    {
        music:"1569212272",
        name:"Five"
    },
    {
        music:"1569220880",
        name:"I Dont Know"
    },
    {
        music:"1569244477",
        name:"My My"
    },
    {
        music:"1569179000",
        name:"Nonono"
    },
    {
        music:"1569192029",
        name:"orion"
    },
    {
        music:"1570166578",
        name:"Bye Bye"
    }
    ]
    twice = [
    {
        music:"1569225408",
        name:"Signal"
    },
    {
        music:"1569174387",
        name:"Happy Happy"
    },
    {
        music:"1569180863",
        name:"Knock Knock"
    },
    {
        music:"1569156686",
        name:"Last Dance The Night Away"
    },
    {
        music:"1569187847",
        name:"Cheer Up"
    },
    {
        music:"1569155161",
        name:"Fancy uu"
    },
    {
        music:"1569229531",
        name:"Heart Sheaker"
    },
    {
        music:"1569248802",
        name:"Likey"
    },
    {
        music:"1570219584",
        name:"TT"
    },
    {
        music:"1569167345",
        name:"What Is Love"
    },
    {
        music:"1570178170",
        name:"Yes Or Yes"
    },
    {
        music:"1569164712",
        name:"CandyPop"
    }
    ];
	
	// Audio Object
	audio = new Audio();
	dir = "http://otupload.orangeoval.net/uploads/";
	playlist = twice.concat(apink,blackpink);
	playModeValue = "0";
	playlist_index = 0;
	ext = ".mp3";
	agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('firefox') != -1 || agent.indexOf('opera') != -1 ){
		ext = ".ogg";
	}
	audio.src = dir+playlist[0].music+ext;
	audio.loop = false;
	audio.play();
	play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
	document.title = play_status.innerText;
	
	playbtn.addEventListener("click", playPause);
	mutebtn.addEventListener("click", mute);
    nextbtn.addEventListener("click", nextPlay);
    prevbtn.addEventListener("click", prevPlay);
	if(isMobile.Android() || isMobile.any() ) {
	/*seekslider.addEventListener("touchend", function(event){ seeking=true; seek(event); });
	seekslider.addEventListener("touchmove", function(event){ seek(event); });
	seekslider.addEventListener("touchstart", function(){ seeking=false; });*/
	
	seekslider.addEventListener("touchstart", function(event){ seeking=true; seekandro(event); });
	seekslider.addEventListener("touchmove", function(event){ seekandro(event); });
	seekslider.addEventListener("touchend", function(){ seeking=false; });
	volumeslider.addEventListener("touchmove", setvolume);
	} else {
	seekslider.addEventListener("mousedown", function(event){ seeking=true; seek(event); });
	seekslider.addEventListener("mousemove", function(event){ seek(event); });
	seekslider.addEventListener("mouseup", function(){ seeking=false; });
	volumeslider.addEventListener("mousemove", setvolume);
	}
	audio.addEventListener("timeupdate", function() { seektimeupdate(); })
	audio.addEventListener("ended", function(){ switchTrack(); });
	listmusic.addEventListener("change", musicList);
	
	for(let i = 0; i < modeSwitch.length ; i++){
	    modeSwitch[i].addEventListener("change", function() {
	        console.log(this.value);
	        if(this == null){
	            playModeValue = 0;
	        }
	        playModeValue = this.value;
	    })
	}
	
	//Functions
	function switchTrack() {
	    if(playModeValue == "1"){
	        if(playlist_index%2 === 0){
	            playlist_index = Math.floor(Math.random() * (playlist.length - 1));
	        }else {
	            playlist_index = Math.floor(Math.random() * (playlist.length - 1));
	            playlist_index + 1;
	        }
	    } else {
    		if(playlist_index == (playlist.length - 1)){
    			playlist_index = 0;
    		} else {
    			playlist_index++;
    		}
	    }
		play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
		document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index].music+ext;
		audio.play();
	}
	
	function musicList(){
	    audio.pause();
	    audio.currentTime = 0;
	    audio.src = "";
	    switch(listmusic.options[listmusic.selectedIndex].value){
	        case "apink":
	            playlist = apink;
	            play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
	            audio.src = dir+playlist[0].music+ext;
    	        break;
    	    case "blackpink":
    	        playlist = blackpink;
    	        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
    	        audio.src = dir+playlist[0].music+ext;
    	        break;
    	    case "twice":
    	        playlist = twice;
    	        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
    	        audio.src = dir+playlist[0].music+ext;
    	        break;
    	       
	    }
    }
	
	function playPause(){
		if(audio.paused){
			audio.play();
			playbtn.innerText = "Pause";
		} else {
			audio.pause();
			playbtn.innerText = "Play";
		}
	}
	function mute(){
		if(audio.muted){
			audio.muted = false;
		} else {
			audio.muted = true;
		}
	}
	function seek(event){
		if(seeking){
			seekslider.value = event.clientX - seekslider.offsetLeft;
			seekto = audio.duration * (seekslider.value / 100);
			audio.currentTime = seekto;
			
		}
	}
	
	function seekandro(event){
		if(seeking){
			seekslider.value = event.touches[0].clientX - seekslider.offsetLeft;
			seekto = audio.duration * (seekslider.value / 100);
			audio.currentTime = seekto;

		}
	}
	
	
	function setvolume() {
		audio.volume = volumeslider.value / 100;
	}
	function seektimeupdate() {
		var nt = audio.currentTime * (100 / audio.duration);
		seekslider.value = nt;
		var curmins = Math.floor(audio.currentTime / 60);
		var cursecs = Math.floor(audio.currentTime - curmins * 60);
		var durmins = Math.floor(audio.duration / 60);
		var dursecs = Math.floor(audio.duration - curmins * 60);
		if(cursecs < 10) { cursecs = "0"+cursecs;}
		if(dursecs < 10) { dursecs = "0"+dursecs;}
		if(curmins < 10) { curmins = "0"+curmins;}
		if(durmins < 10) { durmins = "0"+durmins;}
		curtimetext.innerHTML = curmins+":"+cursecs;
		durtimetext.innerHTML = durmins+":"+dursecs;
	}
    function nextPlay() {
        if(playlist_index > (playlist.length - 1)){
            playlist_index = 0;
        }
        playlist_index++;
        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
        document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index].music+ext;
		audio.play();
    }
    function prevPlay() {
        if(playlist_index < 1 ) {
         alert("Error Mbah");
        }else {
        playlist_index--;
        play_status.innerHTML = "Track "+(playlist_index+1)+" - "+ playlist[playlist_index].name;
        document.title = play_status.innerText;
		audio.src = dir+playlist[playlist_index].music+ext;
		audio.play();
        }
    }
	
}
window.addEventListener("load", initAudioPlayer);
</script>
</body>
</html>